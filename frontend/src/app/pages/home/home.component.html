<mat-toolbar color="primary">
  <span>Dotazník před očkováním proti nemoci COVID-19</span>
</mat-toolbar>

<main>
  <mat-horizontal-stepper [linear]="true">

    <!-- 1. Osobní informace -->
    <mat-step #firstStep [completed]="patientForm.valid" label="Osobní informace">
      <app-container>
        <form #patientForm="ngForm">
          <app-patient-info-form [patient]="patient"></app-patient-info-form>
        </form>

        <div class="nav-buttons">
          <div></div>
          <button [disabled]="!firstStep.completed"
                  color="primary" mat-raised-button matStepperNext>
            Další krok
          </button>
        </div>
      </app-container>
    </mat-step>

    <!-- 2. Zdravotní informace -->
    <mat-step #secondStep [completed]="firstStep.completed && allQuestionsAnswered" label="Zdravotní informace">
      <app-container *ngIf="firstStep.completed">
        <app-patient-questions-form [patient]="patient"></app-patient-questions-form>
        <div class="nav-buttons">
          <button color="secondary" mat-raised-button matStepperPrevious>
            Předchozí krok
          </button>
          <button [disabled]="!secondStep.completed"
                  color="primary" mat-raised-button matStepperNext>
            Další krok
          </button>
        </div>
      </app-container>
    </mat-step>

    <!-- 3. Odeslání požadavku -->
    <mat-step #thirdStep [completed]="!!confirmationCheckboxValue && !!agreementCheckboxValue && !!gdprCheckboxValue" label="Odeslání požadavku">
      <app-container [wide]="true">
        <app-patient-data [patientData]="patient"></app-patient-data>

        <div class="checkboxes">
          <mat-checkbox [(ngModel)]="confirmationCheckboxValue">
            Potvrzuji, že jsem nezamlčel/a žádné informace o svém zdravotním stavu.
          </mat-checkbox>

          <mat-checkbox [(ngModel)]="agreementCheckboxValue">
            Souhlasím s aplikací očkovací látky proti onemocnění COVID-19.
          </mat-checkbox>

          <mat-checkbox [(ngModel)]="gdprCheckboxValue">
            Souhlasím se
            <button mat-button color="primary" (click)="openGdprInfo()">zpracováním osobních údajů</button>
            .
          </mat-checkbox>
        </div>

        <div class="nav-buttons">
          <button color="secondary" mat-raised-button matStepperPrevious>
            Předchozí krok
          </button>
          <button (click)="submit()"
                  [disabled]="!thirdStep.completed"
                  color="primary" mat-raised-button matStepperNext>
            Odeslat požadavek
          </button>
        </div>
      </app-container>
    </mat-step>
  </mat-horizontal-stepper>
</main>

<app-cookies></app-cookies>
